// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlserver"
  url      = env("DATABASE_URL")
}

model Profile {
  id Int      @id @default(autoincrement())
  firstname String 
  lastname String 
  job_title String @default("N/A")
  years_of_experience Int?
  email String? @unique 
  phone_number String?
  competences ProfileCompetence[] 
  diplomas Diploma[]
  createdAt DateTime @default(now())  
  updatedAt DateTime @updatedAt
  jobs TeamMember[]     //* new, possible removal

  certs Cert[]          //? possible removal
  bootcamps Bootcamp[]  //? possible removal
  languages Language[]   //? possible removal
  projects Project[]   //! possible removal: because we have references
}

model ProfileCompetence {
  level Int 
  competenceId Int
  comptence Competence @relation(fields: [competenceId], references: [id])
  profileId Int
  profile Profile @relation(fields: [profileId], references: [id])
  @@id([competenceId, profileId])
}

model Competence {
  id Int      @id @default(autoincrement())
  name String
  tools_list Tool[]
  profile ProfileCompetence[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Language {
  id Int      @id @default(autoincrement())
  name String
  profile Profile[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Tool {
  id Int      @id @default(autoincrement())
  name String
  competence   Competence[]
  project   Project[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Cert {
  id Int      @id @default(autoincrement())
  name String
  completion_year DateTime?
  profile Profile[] 
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Diploma {
  id Int      @id @default(autoincrement()) 
  name String
  source String?
  graduation_year DateTime?
  profile Profile[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Bootcamp {
  id Int      @id @default(autoincrement()) 
  name String
  source String?
  date_obtained DateTime?   //*new
  profile Profile[] 
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}


model Project {
  id Int      @id @default(autoincrement())
  name String
  tools_list Tool[]
  references Reference[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  profiles Profile[]   //! possible removal, cuz of referece
}


//*new
model Task {
  id Int      @id @default(autoincrement())
  nom_tache String
  desc_tache String
  references Reference[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

//*new
model Reference {
  id Int      @id @default(autoincrement())
  projectId Int
  project Project @relation(fields: [projectId], references: [id])
  team TeamMember[]
  tasks Task[]
  client String
  start_date DateTime
  end_date DateTime
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model TeamMember {
  @@id([referenceId, profileId])
  profileId Int
  profile Profile @relation(fields: [profileId], references: [id])
  referenceId Int
  reference Reference  @relation(fields: [referenceId], references: [id])
  post String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
